<div class="courses py-2">
  <div class="topCourses ">

    <div class="footerBanner d-flex justify-content-between align-items-end ">
      <div class="leftFooter d-flex align-items-center gap-3">
        <div class="iconHeader">
          <i class="fa-solid fa-chalkboard-user"></i>
        </div>
        <div class="titleHeader">
          <h3 class="m-0">Courses List</h3>
          <div class="custom-select">
            <button class="select-button" type="button" (click)="toggleDropdown()" [attr.aria-expanded]="isOpen">
              <span class="selected-value">{{ selectedValue | splicText:15}}</span>
              <span class="arrow" [ngClass]="{ open: isOpen }"></span>
            </button>
            <ul class="select-dropdown" [ngClass]="{ hidden: isOpen }">
              <li *ngFor="let option of topicsList ; let i = index" (click)="selectOption(option)">
                <div class="d-flex justify-content-between align-items-center ">
                  <p class="m-0">{{ option.name }}</p>
                  <div class="Icon p-2 rounded-1" [ngClass]="option.color">
                    <i class="fas {{ option.icon }}" aria-hidden="true"></i>
                  </div>


                </div>
              </li>
            </ul>
          </div>

        </div>
      </div>

      <div class="rightFooter d-flex gap-3">
        
        <div class="endBannerRight">
           <div class="leftbanner d-flex align-items-center gap-2 " [class.activeHeader]="valueheader == 0">
          <p-button (onClick)="changeTab(0)" rounded="true" styleClass="tabHeader">
            <div class="icon">
              <i class="fa-solid fa-table"></i>
            </div> 
             <span>Table</span>
          </p-button>
        </div>
        <span class="line"></span>
        <div class="rightbanner d-flex align-items-center pos" [class.activeHeader]="valueheader == 1">

          <p-button (onClick)="changeTab(1)" rounded="true" styleClass="tabHeader">
            <div class="icon">
              <i class="fa-light fa-objects-align-top"></i>
            </div> 
            <span>Kanban</span>
          </p-button>

        </div>
        <button class="openCard" (click)="toggShowInfo()" [class.rotatearrow]="showInfo">
          <i class="fa-solid fa-caret-down"></i>
        </button>
        </div>
       
      </div>
    </div>
  </div>


  <app-widget-courses [showInfo]="showInfo"></app-widget-courses>


  <p-tabs [value]="valueheader" class="m-0">
    <p-tabpanels class="m-0">
      <p-tabpanel [value]="0">
        <div class="showDataCourses ">
          <div class="headerTabs">
            <div class="tab tab1" [class.active]="valueTable == 0">
              <p-button (onClick)="changeInnerTab(0)" rounded="true" styleClass="tabtext">
                All courses <span>+99</span>
              </p-button>
            </div>
            <div class="tab tab2" [class.active]="valueTable == 1">
              <p-button (onClick)="changeInnerTab(1)" rounded="true" styleClass="tabtext">
                Free Courses <span>+99</span>
              </p-button>
            </div>
            <div class="tab tab3" [class.active]="valueTable == 2">
              <p-button (onClick)="changeInnerTab(2)" rounded="true" styleClass="tabtext">
                Sold courses <span>+99</span>
              </p-button>
            </div>
          </div>
          <div class="search-container p-3 px-0 d-flex justify-content-between">
            <div class="search-container-right d-flex gap-3">
              <div class="inputSearch">

                <input type="text" placeholder="Search for courses">
              </div>
              <div class="advanced-filter-container">

                <svg id="advanced-filter-svg" class="my-svg"  xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" ><path _ngcontent-ng-c2580197127="" id="advanced-filter-svg-path1" d="M9.11668 18.875C8.71668 18.875 8.32501 18.775 7.95834 18.575C7.22501 18.1667 6.78334 17.425 6.78334 16.5917V12.175C6.78334 11.7583 6.50834 11.1333 6.25001 10.8167L3.13334 7.51667C2.60834 6.99167 2.20834 6.09167 2.20834 5.41667V3.5C2.20834 2.16667 3.21668 1.125 4.50001 1.125H15.5C16.7667 1.125 17.7917 2.15 17.7917 3.41667V5.25C17.7917 6.125 17.2667 7.11667 16.775 7.60833L13.1667 10.8C12.8167 11.0917 12.5417 11.7333 12.5417 12.25V15.8333C12.5417 16.575 12.075 17.4333 11.4917 17.7833L10.3417 18.525C9.96668 18.7583 9.54168 18.875 9.11668 18.875ZM4.50001 2.375C3.91668 2.375 3.45834 2.86667 3.45834 3.5V5.41667C3.45834 5.725 3.70834 6.325 4.02501 6.64167L7.20001 9.98333C7.62501 10.5083 8.04168 11.3833 8.04168 12.1667V16.5833C8.04168 17.125 8.41668 17.3917 8.57501 17.475C8.92501 17.6667 9.35001 17.6667 9.67501 17.4667L10.8333 16.725C11.0667 16.5833 11.3 16.1333 11.3 15.8333V12.25C11.3 11.3583 11.7333 10.375 12.3583 9.85L15.925 6.69167C16.2083 6.40833 16.55 5.73333 16.55 5.24167V3.41667C16.55 2.84167 16.0833 2.375 15.5083 2.375H4.50001Z" fill="#909EAF"></path><path _ngcontent-ng-c2580197127="" id="advanced-filter-svg-path2" d="M5 8.95833C4.88333 8.95833 4.775 8.925 4.66666 8.86666C4.375 8.68333 4.28333 8.29166 4.46666 8L8.575 1.41666C8.75833 1.125 9.14166 1.03333 9.43333 1.21666C9.725 1.4 9.81666 1.78333 9.63333 2.075L5.525 8.65833C5.40833 8.85 5.20833 8.95833 5 8.95833Z" fill="#909EAF"></path></svg>

              </div>

              <div class="CreationDate position-relative" [ngClass]="{'CreationDateFouce': rangeDates && rangeDates[0]}">
                <div class="icon" id="stage-drop-down-icon-0">
                  <i class="icon-grey fa-kit fa-calendar" id="stage-drop-down-icon-i-0"></i>
                </div>
                <p class="m-0">Creation Date</p>
                <p-datepicker class="icon-only position-relative" [(ngModel)]="rangeDates" selectionMode="range" [readonlyInput]="true" />

              </div>

              <div class="CreationDate">
                <div class="icon" >
                  <i class="icon-grey fa-kit fa-profile-circle"></i>
                </div>
                <p class="m-0">Stage </p>
              </div>
            </div>
            <div class="search-container-left">
              <div class="addCourse">
                <button class="btn-add"><i class="fa fa-plus-square" aria-hidden="true"></i> Add Course</button>
              </div>
            </div>


          </div>

          <!-- التبويبات الداخلية -->
          <p-tabs [value]="valueTable">
            <p-tabpanels>
              <p-tabpanel [value]="0">
                <app-table-courses (fetchCoursesEvent)="fetchCourses($event,selectedTopicId)"
                  [paginationCoursesResponse]="paginationCoursesResponse">
                </app-table-courses>
              </p-tabpanel>
              <p-tabpanel [value]="1">
                <app-table-courses [paginationCoursesResponse]="paginationCoursesResponse"
                  (fetchCoursesEvent)="fetchCourses($event,selectedTopicId ,valueTable )"></app-table-courses>
              </p-tabpanel>
              <p-tabpanel [value]="2">
                <app-table-courses [paginationCoursesResponse]="paginationCoursesResponse"
                  (fetchCoursesEvent)="fetchCourses($event,selectedTopicId , valueTable)"></app-table-courses>
              </p-tabpanel>
            </p-tabpanels>
          </p-tabs>
        </div>
      </p-tabpanel>

      <p-tabpanel [value]="1">
        <div class=" Kanbans bg-white ">

          <div class="headerKanban">

            <div class="inputSearch">
              <input type="text" placeholder="Search for courses">

            </div>

            <div class="addCourse">
              <button class="btn-add"><i class="fa fa-plus-square" aria-hidden="true"></i> Add Course</button>
            </div>


          </div>

          <div class="KanbansCard  d-flex gap-3" #scrollKanpan>
            @if(kanbanResponse.success){
            @for (stageColumn of kanbanResponse.result.topic.stages; track stageColumn.stageId) {
            <app-cardkanban-stage [stageColumn]="stageColumn" [allStages]="kanbanResponse.result.topic.stages"
              (moveCourse)="handleMoveCourse($event)"></app-cardkanban-stage>
            }
            }






          </div>


          <div class="leftScroll" [class.d-none]="!showLeftScroll" (mouseenter)="scrollTable('left')"
            (mouseleave)="stopScroll()">
            <i class="fa-solid fa-chevron-left"></i>
          </div>

          <div class="rightScroll" [class.d-none]="!showRightScroll" (mouseenter)="scrollTable('right')"
            (mouseleave)="stopScroll()">
            <i class="fa-solid fa-chevron-right"></i>
          </div>





        </div>
      </p-tabpanel>
    </p-tabpanels>
  </p-tabs>


  <div class="ShowPopup">
    <div class="add-Course">
      <app-top-pop [NamePopup]="'Add Course'"></app-top-pop>
      <div class="bodyCourse">
        <div class="leftCourse">
          <div class="couseContentAdd">
            <div class="titleCouser">
              <div class="titleText">
                <span class="lineText"></span>
                <h3 >Main course information </h3>

              </div>
              <div class="addData_course my-4">
                <div class="courseDynamic d-flex gap-3 align-items-end mb-2">

                  <div class="Course_name  ">
                    <label for="Course_name">Course name</label>
                    <input type="text" class="input_Couser" id="Course_name" placeholder="Enter course name">
                  </div> 
                  <div  class="deal-desc-btn">
                    <i  class="fa-kit fa-subtitles" ></i>
                  </div>
                </div>
             
                <div class="Course_name">
                  <label for="Course_name">Course description</label>
                  <textarea name="" id=""  class="input_Couser textarea_course" ></textarea>
              </div>
              </div>

            

          </div>
          <div class="Course_Price d-flex gap-3  align-items-start">
            <div class="leftCoursePirce">
              <div class="couresAccess ">
                <div class="titleAccess d-flex justify-content-between gap-2 align-items-center">
                  <p>Course Access</p>
                  <div class="Icon">
                    <i class="fa-solid fa-exclamation"></i>
                  </div>
                </div>

                <app-custom-select 
                [options]="['Paid', 'Free', 'Subscription','Paid', 'Free', 'Subscription']" 
                [selectedValue]="'Paid'" 
                (valueChange)="onSelectChange($event)">
              </app-custom-select>          

              </div>
            </div>
            <div class="rightCoursePirce flex-grow-1">
              <div class="Course_name d-flex flex-column"> 
                <p class="mb-2">Course price</p>
                <div class="input_Couser_container flex-grow-1">
                  <input type="number" placeholder="Enter course price">
                   <span>EGP</span>
                </div>
              </div> 
            </div>

          </div> 

          <div class="courseStage mt-3 d-flex gap-3 align-items-start ">

            <div class="leftStage w-50">
              <div class="titleAccess d-flex justify-content-between gap-2 align-items-center">
                <p>Topic</p>
       
              </div>

              <app-custom-select 
              [options]="['C#', 'C++', 'Python','CSS', 'TS', 'JS']" 
              [selectedValue]="'JS'" 
              (valueChange)="onSelectChange($event)">
            </app-custom-select>     
             
            </div>
            <div class="right w-50">
              <div class="titleAccess d-flex justify-content-between gap-2 align-items-center">
                <p>Stage</p>
       
              </div>

              <app-custom-select 
              [options]="['C#', 'C++', 'Python','CSS', 'TS', 'JS']" 
              [selectedValue]="'JS'" 
              (valueChange)="onSelectChange($event)">
            </app-custom-select>     
             
            </div>

          </div>
          <div class="couserLanguage mt-3">
            <div class="Language w-50">
              <div class="titleAccess d-flex justify-content-between gap-2 align-items-center">
                <p>Course language</p>
       
              </div>

              <app-custom-select 
              [options]="['En' , 'Ar']" 
              [selectedValue]="'En'" 
              (valueChange)="onSelectChange($event)">
            </app-custom-select>     
             
            </div>
          </div>


        </div>

        <div class="couseContentAdd">
          <div class="titleText">
            <span class="lineText" style="background:#FF6584BF ;"></span>
            <h3 >Discount</h3>

          </div>

          
          <div class="courseStage mt-3 d-flex gap-3 align-items-start ">

            <div class="leftStage w-50">
              <div class="titleAccess d-flex justify-content-between gap-2 align-items-center">
                <p>Type</p>
       
              </div>

              <app-custom-select 
              [options]="['C#', 'C++', 'Python','CSS', 'TS', 'JS']" 
              [selectedValue]="'JS'" 
              (valueChange)="onSelectChange($event)">
            </app-custom-select>     
             
            </div>
            <div class="right w-50">
              <div class="titleAccess d-flex justify-content-between gap-2 align-items-center">
                <p>Stage</p>
       
              </div>

              <app-custom-select 
              [options]="['C#', 'C++', 'Python','CSS', 'TS', 'JS']" 
              [selectedValue]="'JS'" 
              (valueChange)="onSelectChange($event)">
            </app-custom-select>     
             
            </div>

          </div>
        </div>
        
        
      </div>

      <div class="rightCourse">
        <div class="UploadCover">
          <div class="inputImage" *ngIf="!selectedImageUrl" (click)="triggerFileInput('image')">
            <i class="fa-solid fa-images"></i>
            <p>{{ selectedImageName || 'Upload course photo' }}</p>
          </div>
          <input type="file" accept="image/*" #ImageInput class="hidenInput" (change)="onFileSelected($event, 'image')">
        
          <img *ngIf="selectedImageUrl" [src]="selectedImageUrl" alt="Selected Image" class="preview-image w-100 h-25 rounded-1">
        </div>
        
        <div class="UploadCover mt-2">
          <div class="inputImage"  *ngIf="!selectedVideoUrl" (click)="triggerFileInput('video')">
            <i class="fa-solid fa-video"></i>
            <p>{{ selectedVideoName || 'Upload course introduction video' }}</p>
          </div>
          <input type="file" accept="video/*" #VideoInput class="hidenInput" (change)="onFileSelected($event, 'video')">
        
          <video *ngIf="selectedVideoUrl" [src]="selectedVideoUrl" controls class="preview-video w-100 h-50 rounded-1"></video>
        </div>
        
        
        <div class="UploadCover mt-2">
          <div class="inputImage" (click)="triggerFileInput('file')">
            <i class="fa-solid fa-file"></i>
            <p>{{ selectedFileName || 'Upload course references' }}</p>
          </div>
          <input type="file" accept=".pdf, .doc, .docx, .xls, .xlsx, .txt" #fileInput class="hidenInput" (change)="onFileSelected($event, 'file')">
        </div>
        <div class="CourseTags UploadCover mt-2 ">
          <div class="tags ">
            <div class="titleText ">
              <span class="lineText" style="background-color:#659DFFBF ;"></span>
              <div class="textTags d-flex gap-2 algin-items-center">
                <h3 >Course custom Tags </h3>
                <div class="Icon">
                  <i class="fa-solid fa-exclamation"></i>
                </div>
    
              </div>
     
         

            </div>

            <div class="mt-3">
              <nz-select nzMode="tags" nzPlaceHolder="Tag Mode" [(ngModel)]="listOfTagOptions">
        
              </nz-select>
            </div>
         
          </div>
          
        </div>

        <div class="CourseTags  mt-2 ">
          <div class="tags  custom-fields-container">
            <div class="titleText ">
              <span class="lineText" style="background-color:#659DFFBF ;"></span>
              <div class="textTags d-flex gap-2 algin-items-center">
                <h3 >Course custom Tags </h3>
                <div class="Icon">
                  <i class="fa-solid fa-exclamation"></i>
                </div>
    
              </div>
     
         

            </div>
          <div class="input-row">
            <input type="text" placeholder="Key" [(ngModel)]="newField.key">
            <input type="text" placeholder="Value" [(ngModel)]="newField.value">
            <button (click)="addField()" class="add-btn">
              <i class="fa-solid fa-plus"></i>
            </button>
          </div>

          <div class="fields-list" [ngClass]="{ 'active': customFields.length > 0 }" >
            <div *ngFor="let field of customFields; let i = index" class="field-item">
              <input type="text" [(ngModel)]="field.key" class="field-key">
              <input type="text" [(ngModel)]="field.value" class="field-value">

              <input type="checkbox" [(ngModel)]="field.checked" class="checkbox">

              <button (click)="removeField(i)" class="delete-btn">
                <i class="fa-regular fa-trash-can"></i>
              </button>
            </div>
          </div>
         
          </div>
          
        </div>


      </div>

      </div>
      <div class="footerCourse bg-white rounded-1">
        <div class="btnsCourse">
          <button class="">Create</button>
        </div>

  
  

        </div>  

</div>
</div>

<!-- <app-tablereused [paginationResponse]="paginationCoursesResponse" [headers]=headers [records]="tableRecords" (fetchRemainingDataEvent)="fetchCourses($event,selectedTopicId ,valueTable )"></app-tablereused> -->